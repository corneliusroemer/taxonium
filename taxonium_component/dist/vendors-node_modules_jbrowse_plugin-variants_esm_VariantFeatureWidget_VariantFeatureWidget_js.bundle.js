"use strict";
(self["webpackChunktaxonium"] = self["webpackChunktaxonium"] || []).push([["vendors-node_modules_jbrowse_plugin-variants_esm_VariantFeatureWidget_VariantFeatureWidget_js"],{

/***/ "./node_modules/@jbrowse/plugin-variants/esm/VariantFeatureWidget/BreakendOptionDialog.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/@jbrowse/plugin-variants/esm/VariantFeatureWidget/BreakendOptionDialog.js ***!
  \************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var mobx_react__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! mobx-react */ "./node_modules/mobx-react/dist/mobxreact.esm.js");
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @mui/material */ "./node_modules/@mui/material/Dialog/Dialog.js");
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @mui/material */ "./node_modules/@mui/material/DialogTitle/DialogTitle.js");
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @mui/material */ "./node_modules/@mui/material/IconButton/IconButton.js");
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @mui/material */ "./node_modules/@mui/material/Divider/Divider.js");
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @mui/material */ "./node_modules/@mui/material/DialogContent/DialogContent.js");
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @mui/material */ "./node_modules/@mui/material/FormControlLabel/FormControlLabel.js");
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @mui/material */ "./node_modules/@mui/material/Checkbox/Checkbox.js");
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @mui/material */ "./node_modules/@mui/material/DialogActions/DialogActions.js");
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @mui/material */ "./node_modules/@mui/material/Button/Button.js");
/* harmony import */ var tss_react_mui__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tss-react/mui */ "./node_modules/tss-react/mui.js");
/* harmony import */ var _mui_icons_material_Close__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @mui/icons-material/Close */ "./node_modules/@mui/icons-material/Close.js");
/* harmony import */ var mobx_state_tree__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! mobx-state-tree */ "./node_modules/mobx-state-tree/dist/mobx-state-tree.module.js");
/* harmony import */ var _jbrowse_core_util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @jbrowse/core/util */ "./node_modules/@jbrowse/core/util/index.js");
/* harmony import */ var _jbrowse_core_util__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_jbrowse_core_util__WEBPACK_IMPORTED_MODULE_2__);
/* eslint-disable @typescript-eslint/no-explicit-any */







const useStyles = (0,tss_react_mui__WEBPACK_IMPORTED_MODULE_1__.makeStyles)()(theme => ({
    closeButton: {
        position: 'absolute',
        right: theme.spacing(1),
        top: theme.spacing(1),
        color: theme.palette.grey[500],
    },
    block: {
        display: 'block',
    },
}));
function BreakendOptionDialog({ model, handleClose, feature, viewType, }) {
    const { classes } = useStyles();
    const [copyTracks, setCopyTracks] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
    const [mirrorTracks, setMirrorTracks] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);
    return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_3__["default"], { open: true, onClose: handleClose },
        react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_4__["default"], null,
            "Breakpoint split view options",
            handleClose ? (react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_5__["default"], { className: classes.closeButton, onClick: () => handleClose() },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_icons_material_Close__WEBPACK_IMPORTED_MODULE_6__["default"], null))) : null),
        react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__["default"], null),
        react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__["default"], null,
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_9__["default"], { className: classes.block, control: react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__["default"], { checked: copyTracks, onChange: () => setCopyTracks(val => !val) }), label: "Copy tracks into the new view" }),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_9__["default"], { className: classes.block, control: react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__["default"], { checked: mirrorTracks, onChange: () => setMirrorTracks(val => !val) }), label: "Mirror tracks vertically in vertically stacked view" })),
        react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_11__["default"], null,
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__["default"], { onClick: () => {
                    const { view } = model;
                    const session = (0,_jbrowse_core_util__WEBPACK_IMPORTED_MODULE_2__.getSession)(model);
                    try {
                        const viewSnapshot = viewType.snapshotFromBreakendFeature(feature, view);
                        viewSnapshot.views[0].offsetPx -= view.width / 2 + 100;
                        viewSnapshot.views[1].offsetPx -= view.width / 2 + 100;
                        viewSnapshot.featureData = feature;
                        const viewTracks = (0,mobx_state_tree__WEBPACK_IMPORTED_MODULE_13__.getSnapshot)(view.tracks);
                        viewSnapshot.views[0].tracks = viewTracks;
                        viewSnapshot.views[1].tracks = mirrorTracks
                            ? viewTracks.slice().reverse()
                            : viewTracks;
                        session.addView('BreakpointSplitView', viewSnapshot);
                    }
                    catch (e) {
                        console.error(e);
                        session.notify(`${e}`);
                    }
                    handleClose();
                }, variant: "contained", color: "primary", autoFocus: true }, "OK"),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__["default"], { onClick: () => handleClose(), color: "secondary", variant: "contained" }, "Cancel"))));
}
/* harmony default export */ __webpack_exports__["default"] = ((0,mobx_react__WEBPACK_IMPORTED_MODULE_14__.observer)(BreakendOptionDialog));
//# sourceMappingURL=BreakendOptionDialog.js.map

/***/ }),

/***/ "./node_modules/@jbrowse/plugin-variants/esm/VariantFeatureWidget/VariantFeatureWidget.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/@jbrowse/plugin-variants/esm/VariantFeatureWidget/VariantFeatureWidget.js ***!
  \************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @mui/material */ "./node_modules/@mui/material/Typography/Typography.js");
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @mui/material */ "./node_modules/@mui/material/FormControlLabel/FormControlLabel.js");
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @mui/material */ "./node_modules/@mui/material/Checkbox/Checkbox.js");
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @mui/material */ "./node_modules/@mui/material/TextField/TextField.js");
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @mui/material */ "./node_modules/@mui/material/Link/Link.js");
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @mui/material */ "./node_modules/@mui/material/Paper/Paper.js");
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @mui/material */ "./node_modules/@mui/material/Divider/Divider.js");
/* harmony import */ var _jbrowse_core_util_simpleFeature__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @jbrowse/core/util/simpleFeature */ "./node_modules/@jbrowse/core/util/simpleFeature.js");
/* harmony import */ var _mui_x_data_grid__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @mui/x-data-grid */ "./node_modules/@mui/x-data-grid/DataGrid/DataGrid.js");
/* harmony import */ var mobx_react__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! mobx-react */ "./node_modules/mobx-react/dist/mobxreact.esm.js");
/* harmony import */ var _jbrowse_core_util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @jbrowse/core/util */ "./node_modules/@jbrowse/core/util/index.js");
/* harmony import */ var _jbrowse_core_util__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_jbrowse_core_util__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var mobx_state_tree__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! mobx-state-tree */ "./node_modules/mobx-state-tree/dist/mobx-state-tree.module.js");
/* harmony import */ var _jbrowse_core_BaseFeatureWidget_BaseFeatureDetail__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @jbrowse/core/BaseFeatureWidget/BaseFeatureDetail */ "./node_modules/@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail.js");
/* harmony import */ var _jbrowse_core_BaseFeatureWidget_BaseFeatureDetail__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_jbrowse_core_BaseFeatureWidget_BaseFeatureDetail__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _BreakendOptionDialog__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./BreakendOptionDialog */ "./node_modules/@jbrowse/plugin-variants/esm/VariantFeatureWidget/BreakendOptionDialog.js");
/* harmony import */ var _gmod_vcf__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @gmod/vcf */ "./node_modules/@gmod/vcf/esm/index.js");
/* eslint-disable @typescript-eslint/no-explicit-any */










function VariantSamples(props) {
    const [filter, setFilter] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({});
    const [showFilters, setShowFilters] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
    const { feature } = props;
    const { samples = {} } = feature;
    const preFilteredRows = Object.entries(samples);
    if (!preFilteredRows.length) {
        return null;
    }
    const infoFields = ['sample', ...Object.keys(preFilteredRows[0][1])].map(field => ({
        field,
    }));
    let error;
    let rows = [];
    const filters = Object.keys(filter);
    // catch some error thrown from regex
    // note: maps all values into a string, if this is not done rows are not
    // sortable by the data-grid
    try {
        rows = preFilteredRows
            .map((row) => ({
            ...Object.fromEntries(Object.entries(row[1]).map(entry => [entry[0], String(entry[1])])),
            sample: row[0],
            id: row[0],
        }))
            .filter((row) => {
            return filters.length
                ? filters.every(key => {
                    const val = row[key];
                    const currFilter = filter[key];
                    return currFilter ? val.match(new RegExp(currFilter, 'i')) : true;
                })
                : true;
        });
    }
    catch (e) {
        error = e;
    }
    // disableSelectionOnClick helps avoid
    // https://github.com/mui-org/material-ui-x/issues/1197
    return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(_jbrowse_core_BaseFeatureWidget_BaseFeatureDetail__WEBPACK_IMPORTED_MODULE_3__.BaseCard, { ...props, title: "Samples" },
        error ? react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_6__["default"], { color: "error" }, `${error}`) : null,
        react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__["default"], { control: react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__["default"], { checked: showFilters, onChange: () => setShowFilters(f => !f) }), label: "Show sample filters" }),
        showFilters ? (react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null,
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_6__["default"], null, "These filters can use a plain text search or regex style query, e.g. in the genotype field, entering 1 will query for all genotypes that include the first alternate allele e.g. 0|1 or 1|1, entering [1-9]\\d* will find any non-zero allele e.g. 0|2 or 2/33"),
            infoFields.map(({ field }) => {
                return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_9__["default"], { key: `filter-${field}`, placeholder: `Filter ${field}`, value: filter[field] || '', onChange: event => setFilter({ ...filter, [field]: event.target.value }) }));
            }))) : null,
        react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { style: { height: 600, width: '100%', overflow: 'auto' } },
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_x_data_grid__WEBPACK_IMPORTED_MODULE_10__.DataGrid, { rows: rows, columns: infoFields, disableSelectionOnClick: true, rowHeight: 25, disableColumnMenu: true }))));
}
function BreakendPanel(props) {
    const { model, locStrings, feature } = props;
    const session = (0,_jbrowse_core_util__WEBPACK_IMPORTED_MODULE_2__.getSession)(model);
    const { pluginManager } = (0,mobx_state_tree__WEBPACK_IMPORTED_MODULE_11__.getEnv)(session);
    const [breakpointDialog, setBreakpointDialog] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);
    let viewType;
    try {
        viewType = pluginManager.getViewType('BreakpointSplitView');
    }
    catch (e) {
        // ignore
    }
    const simpleFeature = new _jbrowse_core_util_simpleFeature__WEBPACK_IMPORTED_MODULE_1__["default"](feature);
    return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(_jbrowse_core_BaseFeatureWidget_BaseFeatureDetail__WEBPACK_IMPORTED_MODULE_3__.BaseCard, { ...props, title: "Breakends" },
        react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_6__["default"], null, "Link to linear view of breakend endpoints"),
        react__WEBPACK_IMPORTED_MODULE_0__.createElement("ul", null, locStrings.map(locString => (react__WEBPACK_IMPORTED_MODULE_0__.createElement("li", { key: `${JSON.stringify(locString)}` },
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__["default"], { href: "#", onClick: event => {
                    var _a;
                    event.preventDefault();
                    const { view } = model;
                    try {
                        if (view) {
                            (_a = view.navToLocString) === null || _a === void 0 ? void 0 : _a.call(view, locString);
                        }
                        else {
                            throw new Error('No view associated with this feature detail panel anymore');
                        }
                    }
                    catch (e) {
                        console.error(e);
                        session.notify(`${e}`);
                    }
                } }, `LGV - ${locString}`))))),
        viewType ? (react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null,
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_6__["default"], null, "Launch split views with breakend source and target"),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("ul", null, locStrings.map(locString => (react__WEBPACK_IMPORTED_MODULE_0__.createElement("li", { key: `${JSON.stringify(locString)}` },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__["default"], { href: "#", onClick: event => {
                        event.preventDefault();
                        setBreakpointDialog(true);
                    } }, `${feature.refName}:${feature.start} // ${locString} (split view)`))))),
            breakpointDialog ? (react__WEBPACK_IMPORTED_MODULE_0__.createElement(_BreakendOptionDialog__WEBPACK_IMPORTED_MODULE_4__["default"], { model: model, feature: simpleFeature, viewType: viewType, handleClose: () => {
                    setBreakpointDialog(false);
                } })) : null)) : null));
}
function VariantFeatureDetails(props) {
    const { model } = props;
    const { featureData, descriptions } = model;
    const feat = JSON.parse(JSON.stringify(featureData));
    const { samples, ...rest } = feat;
    const basicDescriptions = {
        CHROM: 'chromosome: An identifier from the reference genome',
        POS: 'position: The reference position, with the 1st base having position 1',
        ID: 'identifier: Semi-colon separated list of unique identifiers where available',
        REF: 'reference base(s): Each base must be one of A,C,G,T,N (case insensitive).',
        ALT: 'alternate base(s): Comma-separated list of alternate non-reference alleles',
        QUAL: 'quality: Phred-scaled quality score for the assertion made in ALT',
        FILTER: 'filter status: PASS if this position has passed all filters, otherwise a semicolon-separated list of codes for filters that fail',
    };
    return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_13__["default"], { "data-testid": "variant-side-drawer" },
        react__WEBPACK_IMPORTED_MODULE_0__.createElement(_jbrowse_core_BaseFeatureWidget_BaseFeatureDetail__WEBPACK_IMPORTED_MODULE_3__.FeatureDetails, { feature: rest, descriptions: { ...basicDescriptions, ...descriptions }, ...props }),
        react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_14__["default"], null),
        feat.type === 'breakend' ? (react__WEBPACK_IMPORTED_MODULE_0__.createElement(BreakendPanel, { feature: feat, locStrings: feat.ALT.map((alt) => { var _a; return ((_a = (0,_gmod_vcf__WEBPACK_IMPORTED_MODULE_5__.parseBreakend)(alt)) === null || _a === void 0 ? void 0 : _a.MatePosition) || ''; }), model: model })) : null,
        feat.type === 'translocation' ? (react__WEBPACK_IMPORTED_MODULE_0__.createElement(BreakendPanel, { feature: feat, model: model, locStrings: [`${feat.INFO.CHR2[0]}:${feat.INFO.END}`] })) : null,
        react__WEBPACK_IMPORTED_MODULE_0__.createElement(VariantSamples, { feature: feat, ...props })));
}
/* harmony default export */ __webpack_exports__["default"] = ((0,mobx_react__WEBPACK_IMPORTED_MODULE_15__.observer)(VariantFeatureDetails));
//# sourceMappingURL=VariantFeatureWidget.js.map

/***/ })

}]);
//# sourceMappingURL=vendors-node_modules_jbrowse_plugin-variants_esm_VariantFeatureWidget_VariantFeatureWidget_js.bundle.js.map